# Schema for Compliance & Control Assessment Template
# Used by review-draft workflow for sync and confidence scoring

schema_version: "1.0"
template_name: "compliance-control-assessment"
template_description: "Regulatory compliance and control analysis with gap assessment and risk mapping"

# Sections that have sync-enabled detail documents
sections:
  # Section 1: Regulatory Framework Mapping
  - title_pattern: "Regulatory Framework Mapping"
    section_number: 1
    detail_document: null
    structured_id_prefix: "REG"
    sync_enabled: false
    summary_table_header: "| REG# | Regulation | Jurisdiction | Applicability | Compliance Status |"

  # Section 2: Control Point Inventory
  - title_pattern: "Control Point Inventory"
    section_number: 2
    detail_document: "control-points-detail.md"
    structured_id_prefix: "CP"
    sync_enabled: true
    summary_table_header: "| CP# | Control Name | Type | Regulation | Process Step | Effectiveness |"

  # Section 3: Compliance Gap Analysis
  - title_pattern: "Compliance Gap Analysis"
    section_number: 3
    detail_document: null
    structured_id_prefix: "GAP"
    sync_enabled: false
    summary_table_header: "| GAP# | Requirement | Current State | Gap Description | Risk Level | Remediation Priority |"

  # Section 4: Control Effectiveness Assessment
  - title_pattern: "Control Effectiveness Assessment"
    section_number: 4
    detail_document: null
    structured_id_prefix: "CEA"
    sync_enabled: false
    summary_table_header: "| CEA# | Control | Effectiveness Rating | Last Tested | Findings |"

  # Section 5: Audit Trail Requirements
  - title_pattern: "Audit Trail Requirements"
    section_number: 5
    detail_document: null
    structured_id_prefix: "ATR"
    sync_enabled: false
    summary_table_header: "| ATR# | Requirement | Data Elements | Retention Period | System |"

  # Section 6: Risk & Compliance Matrix
  - title_pattern: "Risk & Compliance Matrix"
    section_number: 6
    detail_document: null
    structured_id_prefix: "RCM"
    sync_enabled: false
    summary_table_header: "| RCM# | Risk | Regulation | Control | Residual Risk | Status |"

  # Section 7: Regulatory Change Impact
  - title_pattern: "Regulatory Change Impact"
    section_number: 7
    detail_document: null
    structured_id_prefix: "RCI"
    sync_enabled: false
    summary_table_header: "| RCI# | Regulation | Change Description | Effective Date | Impact | Action Required |"

  # Section 8: Open Audit Findings
  - title_pattern: "Open Audit Findings"
    section_number: 8
    detail_document: null
    structured_id_prefix: "OAF"
    sync_enabled: false
    summary_table_header: "| OAF# | Finding | Source | Date Issued | Severity | Affected Control (CP#) | Status | Target Closure |"

  # Section 9: Control Improvement Recommendations
  - title_pattern: "Control Improvement Recommendations"
    section_number: 9
    detail_document: null
    structured_id_prefix: "CIR"
    sync_enabled: false
    summary_table_header: "| CIR# | Control | Recommendation | Priority | Effort | Expected Benefit |"

# Confidence scoring rules
confidence_rules:
  high_threshold: 90
  medium_threshold: 70

  # Fields that indicate incomplete content
  incomplete_markers:
    - "[TBD]"
    - "[Unknown]"
    - "[TODO]"
    - "{{.*}}"
    - "..."

  # Required cross-references by section
  required_references:
    2:  # Control Point Inventory
      - "CP#"
      - "REG#"
    3:  # Compliance Gap Analysis
      - "GAP#"
      - "REG#"
      - "CP#"
    4:  # Control Effectiveness
      - "CEA#"
      - "CP#"
    6:  # Risk & Compliance Matrix
      - "RCM#"
      - "CP#"
      - "REG#"
    8:  # Open Audit Findings
      - "OAF#"
      - "CP#"
    9:  # Control Improvement
      - "CIR#"
      - "CP#"

# Structured ID patterns for validation
# Format: {PREFIX}-{PROCESS_ABBREV}-{SEQ} (e.g., REG-ONB-001, CP-CRO-002)
# Pattern matches: PREFIX, dash, 2-4 uppercase letters (process abbrev), dash, 3 digits
id_patterns:
  regulation: "REG-[A-Z]{2,4}-\\d{3}"
  control_point: "CP-[A-Z]{2,4}-\\d{3}"
  compliance_gap: "GAP-[A-Z]{2,4}-\\d{3}"
  control_effectiveness: "CEA-[A-Z]{2,4}-\\d{3}"
  audit_trail: "ATR-[A-Z]{2,4}-\\d{3}"
  risk_compliance: "RCM-[A-Z]{2,4}-\\d{3}"
  regulatory_change: "RCI-[A-Z]{2,4}-\\d{3}"
  open_audit_finding: "OAF-[A-Z]{2,4}-\\d{3}"
  control_improvement: "CIR-[A-Z]{2,4}-\\d{3}"

# Companion documents
companion_documents:
  - name: "Control Points Detail"
    file: "control-points-detail.md"
    sync_section: 2

  - name: "AS-IS Process Documentation"
    file: "as-is-process-documentation.md"
    sync_section: null

# Risk rating configuration
risk_ratings:
  levels:
    - level: "Critical"
      score_range: "9-10"
      response_time: "Immediate"
    - level: "High"
      score_range: "7-8"
      response_time: "30 days"
    - level: "Medium"
      score_range: "4-6"
      response_time: "90 days"
    - level: "Low"
      score_range: "1-3"
      response_time: "Next review cycle"

# Control effectiveness ratings (5-point scale)
effectiveness_ratings:
  - rating: "Highly Effective"
    score: 5
    description: "Control consistently operates as designed with strong evidence"
  - rating: "Effective"
    score: 4
    description: "Control operates as designed with minor variations"
  - rating: "Partially Effective"
    score: 3
    description: "Control operates but with notable deficiencies"
  - rating: "Ineffective"
    score: 2
    description: "Control does not reliably achieve its objective"
  - rating: "Not Operating"
    score: 1
    description: "Control is not being performed"

# Effectiveness assessment dimensions
effectiveness_dimensions:
  - name: "Consistency"
    description: "Is the control performed every time it should be?"
  - name: "Detection"
    description: "Does it catch exceptions when they occur?"
  - name: "Evidence Quality"
    description: "Is there adequate proof the control was performed?"
  - name: "Accountability"
    description: "Is there clear ownership and follow-up?"
  - name: "Timeliness"
    description: "Is the control performed when it should be?"

# Change log format
change_log:
  section_title: "Change Log"
  table_format: "| Date | Contributor | Role | Changes |"
